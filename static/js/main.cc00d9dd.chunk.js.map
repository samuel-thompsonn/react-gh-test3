{"version":3,"sources":["logo.svg","ResponseBox.js","UploadSettingsDialog.js","App.js","reportWebVitals.js","index.js"],"names":["PurpleSwitch","withStyles","switchBase","color","blue","backgroundColor","checked","track","Switch","useStyles","makeStyles","theme","paperRoot","width","height","borderColor","ResponseBox","id","whatPrinciples","onChange","startTags","hasStartContent","classes","React","useState","hasContent","setContent","map","tagName","index","tags","setTags","length","tagCounter","setTagCounter","tagElements","useRef","checkForContent","modifiedId","newValue","tag","handleTagChange","event","target","value","replace","handleAddTag","push","handleRemoveTag","filter","handleContentTagSubmit","key","preventDefault","document","activeElement","blur","useEffect","content","contentTags","className","Paper","elevation","Typography","display","ref","TextField","autoFocus","placeholder","onKeyPress","InputProps","endAdornment","InputAdornment","position","Tooltip","title","IconButton","onClick","size","FormGroup","FormControlLabel","control","label","labelPlacement","UploadSettingsDialog","uploaderSettings","startRow","idColumn","usePrincipColumn","whatColumn","anyContentColumn","numFactorsColumn","contentCodedColumn","alphEachResponseColumn","type","parseInt","inputProps","min","input","headerText","App","defaultEnvSettings","process","usePrincip","whatPrincip","responses","setResponses","workbook","setWorkbook","mappedScoreData","setMappedScoreData","fileName","setFileName","settingsOpen","setSettingsOpen","setUploaderSettings","tempUploaderSettings","setTempUploaderSettings","getCell","worksheet","column","row","column_letter","toString","toUpperCase","console","log","cellIndex","cell","cellIndexByValue","rowIndex","currCell","listToCommaSep","stringList","output","i","clearResponses","accept","files","file","XlsxPopulate","then","newWorkbook","split","pop","sheet","dataResponses","localResponses","currentRow","principCell","idCell","whatCell","numFactorsCell","tagsCell","currentTags","trim","response","numFactors","getRawDataResponses","startCell","c","r","setDefaultSheetvalues","mappedScoringResponses","htmlFor","Button","variant","component","Dialog","open","DialogTitle","DialogContent","newSettings","DialogActions","allContentTags","Object","values","scoring","targetRow","columnIndex","setColumnValues","sort","outputAsync","popBlob","window","navigator","msSaveOrOpenBlob","url","URL","createObjectURL","a","createElement","body","appendChild","href","download","click","revokeObjectURL","removeChild","downloadWorkbook","targetData","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","getElementById"],"mappings":"+jBAAe,I,uOCYTA,EAAeC,YAAW,CAC5BC,WAAY,CACVC,MAAOC,IAAK,IACZ,YAAa,CACXD,MAAOC,IAAK,MAEd,qBAAsB,CACpBC,gBAAiBD,IAAK,OAG1BE,QAAS,GACTC,MAAO,IAXUN,CAYhBO,KAECC,EAAYC,aAAW,SAAAC,GAAK,MAAK,CACnCC,UAAW,CACPC,MAAM,OACNC,OAAQ,OACRT,gBAAiB,UACjBU,YAAa,YAIN,SAASC,EAAT,GAAmF,IAA5DC,EAA2D,EAA3DA,GAAIC,EAAuD,EAAvDA,eAAgBC,EAAuC,EAAvCA,SAAUC,EAA6B,EAA7BA,UAAWC,EAAkB,EAAlBA,gBAErEC,EAAUb,IAEhB,EAAiCc,IAAMC,SAASH,GAAhD,mBAAOI,EAAP,KAAmBC,EAAnB,KACA,EAAwBH,IAAMC,SAC1BJ,EAAUO,KAAI,SAACC,EAASC,GACpB,MAAO,CACHZ,GAAIY,EACJD,QAASA,OAJrB,mBAAOE,EAAP,KAAaC,EAAb,KAQA,EAAoCR,IAAMC,SAASJ,EAAUY,OAAS,GAAtE,mBAAOC,EAAP,KAAmBC,EAAnB,KACMC,EAAcZ,IAAMa,OAAO,MAEjC,SAASC,IAA6C,IAA7BC,EAA4B,wDAAhB,EAAGC,EAAa,uDAAJ,GAE7C,GAAiB,KAAbA,EAAmB,OAAO,EAFmB,oBAGjCT,GAHiC,IAGjD,2BAAsB,CAAC,IAAdU,EAAa,QAClB,GAAIA,EAAIvB,KAAOqB,GAA8B,KAAhBE,EAAIZ,QAC7B,OAAO,GALkC,8BAQjD,MAAoB,KAAbW,EAGX,IAAME,EAAkB,SAACxB,GAAD,OAAQ,SAACyB,GAC7B,IAAMH,EAAWG,EAAMC,OAAOC,MAAMC,QAAQ,OAAO,IACnDd,EAASD,EAAKH,KAAI,SAACa,GACf,MAAO,CACHvB,GAAIuB,EAAIvB,GACRW,QAAUY,EAAIvB,KAAOA,EAAKsB,EAAWC,EAAIZ,aAGjDF,EAAWW,EAAgBpB,EAAIsB,MAG7BO,EAAe,WACjBZ,EAAcD,EAAW,GACzBH,EAAKiB,KAAK,CACN9B,GAAIgB,EACJL,QAAS,KAEbG,EAAQD,IAINkB,EAAkB,SAAC/B,GAAD,OAAQ,WAC5Bc,EAAQD,EAAKmB,QAAO,SAACT,GAAD,OAASA,EAAIvB,IAAMA,MACvCS,EAAWW,EAAgBpB,MAGzBiC,EAAyB,SAACR,GAC5B,IAAMS,EAAMT,EAAMS,IACN,UAARA,GAA2B,MAARA,IACnBT,EAAMU,iBACNN,KAEQ,WAARK,GACAE,SAASC,cAAcC,QAa/B,OATAhC,IAAMiC,WAAU,WACZrC,EAAS,CACLF,GAAIA,EACJwC,QAAShC,EACTiC,YAAa5B,EAAKH,KAAI,SAACa,GAAD,OAASA,EAAIZ,WAASqB,QAAO,SAACrB,GAAD,MAAwB,IAAXA,SAErE,CAACE,EAAML,IAIN,qBAAKkC,UAAU,eAAf,SACI,eAACC,EAAA,EAAD,CAAOD,UAAWrC,EAAQV,UAAWiD,UAAW,EAAhD,UACA,qBAAKF,UAAU,eAAf,SACI,eAACG,EAAA,EAAD,CAAYC,QAAQ,SAApB,iBAAkC9C,OAEtC,qBAAK0C,UAAU,wBAAf,SACI,cAACG,EAAA,EAAD,CAAYC,QAAQ,QAApB,SAA6B7C,MAEjC,sBAAKyC,UAAU,mBAAf,UACI,sBAAKA,UAAU,0BAAf,UACK7B,EAAKH,KAAI,SAACa,GACP,OACI,qBAAKmB,UAAU,gBAAgBK,IAAK7B,EAApC,SACI,cAAC8B,EAAA,EAAD,CACIC,WAAS,EACTC,YAAY,eACZC,WAAYlB,EACZN,MAAOJ,EAAIZ,QACXT,SAAUsB,EAAgBD,EAAIvB,IAC9B+C,IAAK7B,EACLkC,WAAY,CACRC,aACI,cAACC,EAAA,EAAD,CAAgBC,SAAS,MAAzB,SACI,cAACC,EAAA,EAAD,CAASC,MAAM,SAAf,SACI,cAACC,EAAA,EAAD,CACI,aAAW,6BACXC,QAAS5B,EAAgBR,EAAIvB,IAC7B4D,KAAK,QAHT,SAKI,cAAC,IAAD,kBAUpC,cAACJ,EAAA,EAAD,CAASC,MAAM,UAAf,SACI,cAACC,EAAA,EAAD,CAAYC,QAAS9B,EAArB,SAAmC,cAAC,IAAD,WAI3C,qBAAKa,UAAU,wBAAf,SACI,cAACmB,EAAA,EAAD,UACI,cAACL,EAAA,EAAD,CAASC,MAAM,6DAAf,SACI,cAACK,EAAA,EAAD,CACIC,QAAS,cAAChF,EAAD,CACLM,QAASmB,EACTN,SAAU,SAACuB,OAEfuC,MAAM,WACNC,eAAe,sBChKhC,SAASC,EAAT,GAAqM,IAAD,IAApKC,iBAAoBC,EAAgJ,EAAhJA,SAAUC,EAAsI,EAAtIA,SAAUC,EAA4H,EAA5HA,iBAAkBC,EAA0G,EAA1GA,WAAYC,EAA8F,EAA9FA,iBAAkBC,EAA4E,EAA5EA,iBAAkBC,EAA0D,EAA1DA,mBAAoBC,EAAsC,EAAtCA,uBAA0BzE,EAAY,EAAZA,SACnM,OACI,gCACI,cAAC8C,EAAA,EAAD,CACI4B,KAAK,SACLZ,MAAM,iBACNrC,MAAOyC,EACPlE,SAAU,SAACuB,GAAD,OAAWvB,EAAS,CAAEkE,SAAUS,SAASpD,EAAMC,OAAOC,UAChEmD,WAAY,CACRC,IAAK,KAGb,cAAC/B,EAAA,EAAD,CACI4B,KAAK,SACLZ,MAAM,gBACNrC,MAAO0C,EACPnE,SAAU,SAACuB,GAAD,OAAWvB,EAAS,CAAEmE,SAAUQ,SAASpD,EAAMC,OAAOC,UAChEmD,WAAY,CACRC,IAAK,KAGb,cAAC/B,EAAA,EAAD,CACI4B,KAAK,SACLZ,MAAM,yBACNrC,MAAO2C,EACPpE,SAAU,SAACuB,GAAD,OAAWvB,EAAS,CAAEoE,iBAAkBO,SAASpD,EAAMC,OAAOC,UACxEmD,WAAY,CACRC,IAAK,KAGb,cAAC/B,EAAA,EAAD,CACI4B,KAAK,SACLZ,MAAM,kBACNrC,MAAO4C,EACPrE,SAAU,SAACuB,GAAD,OAAWvB,EAAS,CAAEqE,WAAYM,SAASpD,EAAMC,OAAOC,UAClEmD,WAAY,CACRC,IAAK,KAGb,cAAC/B,EAAA,EAAD,CACI4B,KAAK,SACLZ,MAAM,wBACNrC,MAAO6C,EACPtE,SAAU,SAACuB,GAAD,OAAWvB,EAAS,CAAEsE,iBAAkBK,SAASpD,EAAMC,OAAOC,UACxEmD,WAAY,CACRC,IAAK,KAGb,cAAC/B,EAAA,EAAD,CACI4B,KAAK,SACLZ,MAAM,sBACNrC,MAAO8C,EACPvE,SAAU,SAACuB,GAAD,OAAWvB,EAAS,CAAEuE,iBAAkBI,SAASpD,EAAMC,OAAOC,UACxEmD,WAAY,CACRC,IAAK,KAGb,cAAC/B,EAAA,EAAD,CACI4B,KAAK,SACLZ,MAAM,0BACNrC,MAAO+C,EACPxE,SAAU,SAACuB,GAAD,OAAWvB,EAAS,CAAEwE,mBAAoBG,SAASpD,EAAMC,OAAOC,UAC1EmD,WAAY,CACRC,IAAK,KAGb,cAAC/B,EAAA,EAAD,CACI4B,KAAK,SACLZ,MAAM,2BACNrC,MAAOgD,EACPzE,SAAU,SAACuB,GAAD,OAAWvB,EAAS,CAAEyE,uBAAwBE,SAASpD,EAAMC,OAAOC,UAC9EmD,WAAY,CACRC,IAAK,QC5DzB,IAAMvF,EAAYC,aAAW,SAACC,GAAD,MAAY,CACvCsF,MAAO,CACLlC,QAAS,QAEXmC,WAAY,CACV/F,MAAO,WAETS,UAAW,CACTP,gBAAiB,WA6PN8F,MAzPf,WAEE,IAAMC,EAAqB,CACzBf,SAAUS,SAASO,KACnBf,SAAUQ,SAASO,KACnBd,iBAAkBO,SAASO,KAC3Bb,WAAYM,SAASO,KACrBZ,iBAAkBK,SAASO,KAC3BX,iBAAkBI,SAASO,KAC3BV,mBAAoBG,SAASO,KAC7BT,uBAAwBE,SAASO,MAG7B/E,EAAUb,IAEhB,EAAkCc,IAAMC,SAAS,CAAC,CAAEP,GAAI,EAAGqF,WAAY,KAAMC,YAAa,SAA1F,mBAAOC,EAAP,KAAkBC,EAAlB,KACA,EAAgClF,IAAMC,SAAS,MAA/C,mBAAOkF,EAAP,KAAiBC,EAAjB,KACA,EAA8CpF,IAAMC,SAAS,IAA7D,mBAAOoF,EAAP,KAAwBC,EAAxB,KACA,EAAgCtF,IAAMC,SAAS,yDAA/C,mBAAOsF,EAAP,KAAiBC,EAAjB,KACA,EAAwCxF,IAAMC,UAAS,GAAvD,mBAAOwF,EAAP,KAAqBC,EAArB,KACA,EAAgD1F,IAAMC,SAAS4E,GAA/D,mBAAOhB,EAAP,KAAyB8B,EAAzB,KACA,EAAwD3F,IAAMC,SAAS4E,GAAvE,mBAAOe,EAAP,KAA6BC,EAA7B,KAgCA,SAASC,EAAQC,EAAWC,EAAQC,GAElC,IAAMC,GAAiBF,EAAO,IAAIG,SAAS,IAAIC,cAC/CC,QAAQC,IAAIJ,GACZ,IAAMK,EAAYL,GAAiBD,EAAM,GAEzC,OADAI,QAAQC,IAAIC,GACLR,EAAUS,KAAKP,EAAI,EAAGD,EAAO,GAgEtC,SAASS,EAAiBV,EAAWC,EAAQ3E,GAE3C,IAF+D,IAAbyC,EAAY,uDAAH,EACvD4C,EAAW5C,IACF,CACX,IAAI6C,EAAWb,EAAQC,EAAWC,EAAQU,GAC1C,IAAKC,EAAY,OAAQ,EACzB,GAAID,EAAW,IAEb,OADAL,QAAQC,IAAI,kCACJ,EAEV,GAAIK,EAAStF,UAAYA,EAAS,OAAOqF,EACzCA,KAIJ,SAASE,EAAeC,GAEtB,IADA,IAAIC,EAAS,GACJC,EAAI,EAAGA,EAAIF,EAAWpG,OAAQsG,IACrCD,GAAUD,EAAWE,GACjBA,GAAKF,EAAWpG,OAAS,IAC3BqG,GAAU,MAGd,OAAOA,EAUT,IAyBME,EAAiB,WACrB9B,EAAa,KAaf,OACE,sBAAK9C,WAAS,EAAd,UACE,sBAAKA,UAAU,iBAAf,UACE,sBAAKA,UAAU,eAAf,UACE,uBACEkC,KAAK,OACL2C,OAAO,QACP7E,UAAWrC,EAAQ2E,MACnBhF,GAAG,wBACHE,SA3Ge,SAACuB,GACxB,GAAkC,IAA9BA,EAAMC,OAAO8F,MAAMzG,OAAvB,CAGA,IAAI0G,EAAOhG,EAAMC,OAAO8F,MAAM,GAC9BE,gBAA2BD,GACxBE,MAAK,SAACC,GACL9B,EAAYrE,EAAMC,OAAOC,MAAMkG,MAAM,MAAMC,OAC3CR,IACA5B,EAAYkC,GACZ,IAAIvB,EAAYuB,EAAYG,MAAM,OAC9BC,EApFV,SAA6B3B,EAA7B,GAGE,IAHmI,IAA3FjC,EAA0F,EAA1FA,SAAUC,EAAgF,EAAhFA,SAAUC,EAAsE,EAAtEA,iBAAkBC,EAAoD,EAApDA,WAAYE,EAAwC,EAAxCA,iBAAkBC,EAAsB,EAAtBA,mBACxGuD,EAAiB,GACjBC,EAAa,IACJ,CACX,IAAIC,EAAc/B,EAAQC,EAAW/B,EAAkBF,EAAW8D,GAClE,IAAKC,GAAwC,QAAxBA,EAAYxG,SAA6C,OAAxBwG,EAAYxG,QAAqB,MACvF,IAAIyG,EAAShC,EAAQC,EAAWhC,EAAUD,EAAW8D,GACjDG,EAAWjC,EAAQC,EAAW9B,EAAYH,EAAW8D,GACrDI,EAAiBlC,EAAQC,EAAW5B,EAAkBL,EAAW8D,GACjEK,EAAWnC,EAAQC,EAAW3B,EAAoBN,EAAW8D,GAC7DM,EAAc,GACdD,GAAYA,EAAS5G,UACvBgF,QAAQC,IAAI2B,EAAS5G,SAErB6G,EADgBD,EAAS5G,QAAQ8E,WAAWoB,MAAM,MAC5B7F,QAAO,SAACT,GAAD,MAAwB,KAAfA,EAAIkH,WAE5C,IAAIC,EAAW,CACb1I,GAAIoI,EAAOzG,QACX0D,WAAY8C,EAAYxG,QACxB2D,YAAa+C,EAAS1G,QACtBgH,WAAaL,EAAe3G,QAAU2G,EAAe3G,QAAU,EAC/Dd,KAAM2H,GAERP,EAAenG,KAAK4G,GACpBR,IAEF,OAAOD,EA0DiBW,CAAoBvC,EAAWlC,GACnDqB,EAAawC,GA1BnB,SAA+B3B,EAAWwC,GAIxC,IAHA,IAAIX,EAAa,IAGJ,CACX,IAAIC,EAAc/B,EAAQC,EAAWwC,EAAUC,EAAI,EAAGD,EAAUE,EAAIb,GACpE,IAAKC,GAAwC,QAAxBA,EAAYxG,SAA6C,OAAxBwG,EAAYxG,QAAqB,MACvFyE,EAAQC,EAAUlC,EAAiBK,iBAAkBqE,EAAUE,EAAIb,GAAYvG,MAAM,GACrFyE,EAAQC,EAAUlC,EAAiBM,iBAAkBoE,EAAUE,EAAIb,GAAYvG,MAAM,GACrFyE,EAAQC,EAAUlC,EAAiBQ,uBAAwBkE,EAAUE,EAAIb,GAAYvG,MAAM,IAC3FuG,KAiBEc,CAAsB3C,EAAW,CAACyC,EAAE,EAAEC,EAAE,IACxC,IARqB,EAQjBE,EAAyB,GARR,cASAjB,GATA,IASrB,2BAAoC,CAAC,IAA5BU,EAA2B,QAClCO,EAAuBP,EAAS1I,IAAM,CACpCA,GAAI0I,EAAS1I,GACbwC,QAAmC,IAAzBkG,EAAS7H,KAAKE,OACxB0B,YAAaiG,EAAS7H,OAbL,8BAgBrB+E,EAAmBqD,GACnBxH,EAAMC,OAAOC,MAAQ,YAsFnB,uBACEuH,QAAQ,wBADV,SAEE,cAACC,EAAA,EAAD,CAAQC,QAAQ,YAAYC,UAAU,OAAtC,kCAEF,cAACF,EAAA,EAAD,CAAQxF,QAAS,kBAAMqC,GAAgB,IAAvC,iCACA,eAACsD,EAAA,EAAD,CAAQC,KAAMxD,EAAc,kBAAgB,wBAA5C,UACE,cAACyD,EAAA,EAAD,CAAaxJ,GAAG,wBAAhB,+BACA,cAACyJ,EAAA,EAAD,UACE,cAACvF,EAAD,CACEC,iBAAkB+B,EAClBhG,SAAU,SAACwJ,GAAkBvD,EAAwB,2BAAKD,GAAyBwD,SAGvF,eAACC,EAAA,EAAD,WACE,cAACR,EAAA,EAAD,CAAQxF,QA9BS,WAC3BqC,GAAgB,GAChBG,EAAwB,eAAIhC,KA4BlB,oBACA,cAACgF,EAAA,EAAD,CAAQxF,QApCS,WAC3BqC,GAAgB,GAChBC,EAAoB,2BAAI9B,GAAqB+B,KAkCnC,yBAGJ,eAACrD,EAAA,EAAD,CAAYH,UAAWrC,EAAQ4E,WAA/B,0BAAyDY,QAE3D,qBAAKnD,UAAU,qBAAf,SACE,cAACyG,EAAA,EAAD,CAAQC,QAAQ,YAAYzF,QAvEd,WAEpB,GADAgD,QAAQC,IAAI,0CACPnB,EAAL,CAMA,IAFA,IAAIY,EAAYZ,EAASsC,MAAM,OAC3B6B,EAAiB,GACrB,MAAoBC,OAAOC,OAAOnE,GAAlC,eAAoD,CAA/C,IAAIoE,EAAO,KACVC,EAAYjD,EAAiBV,EAAWlC,EAAiBE,SAAU0F,EAAQ/J,GAAI,IAChE,IAAfgK,IACJ5D,EAAQC,EAAWlC,EAAiBK,iBAAkBwF,GAAWrI,MAAOoI,EAAQvH,QAAU,EAAI,GAC9F4D,EAAQC,EAAWlC,EAAiBM,iBAAkBuF,GAAWrI,MAAMoI,EAAQtH,YAAY1B,QAC3FqF,EAAQC,EAAWlC,EAAiBO,mBAAoBsF,GAAWrI,MAAMuF,EAAe6C,EAAQtH,cAChGmH,EAAe9H,KAAf,MAAA8H,EAAc,YAAUG,EAAQtH,gBApBpC,SAAyB4D,EAAW4D,EAAaH,GAC/C,IADoE,IAAb1F,EAAY,uDAAH,EACvDiD,EAAI,EAAGA,EAAIyC,EAAO/I,OAAQsG,IACjCjB,EAAQC,EAAW4D,EAAa7F,EAAWiD,GAAG1F,MAAMmI,EAAOzC,IAoB7D6C,CAAgB7D,EAAWlC,EAAiBQ,uBAAwBiF,EAAeO,OAAQ,GA7G7F,SAA0B1E,EAAUI,GAElCJ,EAAS2E,cACNzC,MAAK,SAAC0C,GACL,GAAIC,OAAOC,WAAaD,OAAOC,UAAUC,iBACvCF,OAAOC,UAAUC,iBAAiBH,EAAS,yBAExC,CACH,IAAII,EAAMH,OAAOI,IAAIC,gBAAgBN,GACjCO,EAAIxI,SAASyI,cAAc,KAC/BzI,SAAS0I,KAAKC,YAAYH,GAC1BA,EAAEI,KAAOP,EACTG,EAAEK,SAAWpF,EAXK,QAYlB+E,EAAEM,QACFZ,OAAOI,IAAIS,gBAAgBV,GAC3BrI,SAAS0I,KAAKM,YAAYR,OA+FhCS,CAAiB5F,EAAU,sBAdzBkB,QAAQC,IAAI,iBAoER,uCAGJ,qBAAKlE,UAAU,+BAAf,SACG6C,EAAU7E,KAAI,SAACgI,GACd,MAA4B,OAAxBA,EAASrD,YAAgD,KAAzBqD,EAASpD,aAAwBoD,EAASpD,YAE5E,qBAAK5C,UAAU,qBAAf,SACE,cAAC,EAAD,CACE1C,GAAI0I,EAAS1I,GACbC,eAAgByI,EAASpD,YACzBpF,UA9DeF,EA8De0I,EAAS1I,GA9DjB,SAACsL,GACnC3F,EAAgB3F,GAAMsL,EACtB1F,EAAmBD,KA6DPxF,UAAWuI,EAAS7H,KACpBT,gBAA0C,IAAzBsI,EAAS7H,KAAKE,WARgE,KAxDjF,IAACf,WC7LhBuL,EAZS,SAAAC,GAClBA,GAAeA,aAAuBC,UACxC,8BAAqB9D,MAAK,YAAkD,IAA/C+D,EAA8C,EAA9CA,OAAQC,EAAsC,EAAtCA,OAAQC,EAA8B,EAA9BA,OAAQC,EAAsB,EAAtBA,OAAQC,EAAc,EAAdA,QAC3DJ,EAAOF,GACPG,EAAOH,GACPI,EAAOJ,GACPK,EAAOL,GACPM,EAAQN,OCDdO,IAASC,OACP,cAAC,IAAMC,WAAP,UACE,cAAC,EAAD,MAEF7J,SAAS8J,eAAe,SAM1BX,M","file":"static/js/main.cc00d9dd.chunk.js","sourcesContent":["export default __webpack_public_path__ + \"static/media/logo.6ce24c58.svg\";","import React from 'react'\r\nimport Switch from '@material-ui/core/Switch'\r\nimport FormGroup from '@material-ui/core/FormGroup';\r\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\r\nimport { Button, InputAdornment, makeStyles, Paper, Tooltip, Typography, withStyles } from '@material-ui/core';\r\nimport { TextField } from '@material-ui/core';\r\nimport { IconButton } from '@material-ui/core';\r\nimport AddIcon from '@material-ui/icons/Add';\r\nimport ClearIcon from '@material-ui/icons/Clear';\r\nimport { blue } from '@material-ui/core/colors';\r\nimport './ResponseBox.css'\r\n\r\nconst PurpleSwitch = withStyles({\r\n    switchBase: {\r\n      color: blue[50],\r\n      '&$checked': {\r\n        color: blue[900],\r\n      },\r\n      '&$checked + $track': {\r\n        backgroundColor: blue[900],\r\n      },\r\n    },\r\n    checked: {},\r\n    track: {},\r\n  })(Switch);\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n    paperRoot: {\r\n        width:'100%',\r\n        height: '100%',\r\n        backgroundColor: '#343a42',\r\n        borderColor: 'gray'\r\n    }\r\n}));\r\n\r\nexport default function ResponseBox({ id, whatPrinciples, onChange, startTags, hasStartContent}) {\r\n\r\n    const classes = useStyles();\r\n\r\n    const [hasContent, setContent] = React.useState(hasStartContent);\r\n    const [tags, setTags] = React.useState(\r\n        startTags.map((tagName, index) => {\r\n            return {\r\n                id: index,\r\n                tagName: tagName,\r\n            }\r\n        })\r\n    );\r\n    const [tagCounter, setTagCounter] = React.useState(startTags.length + 5);\r\n    const tagElements = React.useRef(null);\r\n\r\n    function checkForContent(modifiedId=-1, newValue=\"\") {\r\n        // Could move this to the end, but it saves some looping here.\r\n        if (newValue !== \"\") { return true; }\r\n        for (let tag of tags) {\r\n            if (tag.id !== modifiedId && tag.tagName !== \"\") {\r\n                return true;\r\n            }\r\n        }\r\n        return newValue !== \"\";\r\n    }\r\n\r\n    const handleTagChange = (id) => (event) => {\r\n        const newValue = event.target.value.replace(/^\\s*/,'');\r\n        setTags((tags.map((tag) => {\r\n            return {\r\n                id: tag.id,\r\n                tagName: (tag.id === id)? newValue : tag.tagName\r\n            }\r\n        })))\r\n        setContent(checkForContent(id, newValue));\r\n    }\r\n\r\n    const handleAddTag = () => {\r\n        setTagCounter(tagCounter+1);\r\n        tags.push({\r\n            id: tagCounter,\r\n            tagName: \"\",\r\n        })\r\n        setTags(tags);\r\n        // tagElements.current.focus();\r\n    }\r\n\r\n    const handleRemoveTag = (id) => () => {\r\n        setTags(tags.filter((tag) => tag.id != id));\r\n        setContent(checkForContent(id))\r\n    }\r\n\r\n    const handleContentTagSubmit = (event) => {\r\n        const key = event.key;\r\n        if (key === 'Enter' || key === ',') { \r\n            event.preventDefault();\r\n            handleAddTag(); \r\n        }\r\n        if (key === 'Escape') { \r\n            document.activeElement.blur(); \r\n        }\r\n    }\r\n\r\n    React.useEffect(() => {\r\n        onChange({\r\n            id: id,\r\n            content: hasContent,\r\n            contentTags: tags.map((tag) => tag.tagName).filter((tagName) => tagName != ''),\r\n        });\r\n    }, [tags, hasContent])\r\n\r\n\r\n    return (\r\n        <div className=\"response-box\">\r\n            <Paper className={classes.paperRoot} elevation={3} >\r\n            <div className=\"id-container\">\r\n                <Typography display=\"inline\">ID: {id}</Typography>\r\n            </div>\r\n            <div className=\"explanation-container\">\r\n                <Typography display=\"block\">{whatPrinciples}</Typography>\r\n            </div>\r\n            <div className=\"coding-container\">\r\n                <div className=\"content-codes-container\">\r\n                    {tags.map((tag) => {\r\n                        return (\r\n                            <div className=\"tag-container\" ref={tagElements}>\r\n                                <TextField \r\n                                    autoFocus\r\n                                    placeholder=\"Content code\"\r\n                                    onKeyPress={handleContentTagSubmit}\r\n                                    value={tag.tagName} \r\n                                    onChange={handleTagChange(tag.id)}\r\n                                    ref={tagElements}\r\n                                    InputProps={{\r\n                                        endAdornment: (\r\n                                            <InputAdornment position=\"end\">\r\n                                                <Tooltip title=\"Remove\">\r\n                                                    <IconButton\r\n                                                        aria-label=\"toggle password visibility\"\r\n                                                        onClick={handleRemoveTag(tag.id)}\r\n                                                        size=\"small\"\r\n                                                    >\r\n                                                        <ClearIcon/>\r\n                                                    </IconButton>\r\n                                                </Tooltip>\r\n\r\n                                            </InputAdornment>\r\n                                    )}}>\r\n                                </TextField>\r\n                            </div>\r\n                        )\r\n                    })}\r\n                    <Tooltip title=\"Add tag\">\r\n                        <IconButton onClick={handleAddTag}><AddIcon/></IconButton>\r\n                    </Tooltip>\r\n                    \r\n                </div>\r\n                <div className=\"has-content-container\">\r\n                    <FormGroup>\r\n                        <Tooltip title=\"Enabled if one or more non-empty content codes are listed.\">\r\n                            <FormControlLabel\r\n                                control={<PurpleSwitch \r\n                                    checked={hasContent} \r\n                                    onChange={(event)=>{/*setContent(event.target.checked)*/}}>\r\n                                </PurpleSwitch>}\r\n                                label=\"Content?\"\r\n                                labelPlacement=\"top\"\r\n                            />  \r\n                        </Tooltip>\r\n                        \r\n                    </FormGroup>\r\n                </div>\r\n            </div>\r\n            </Paper>\r\n        </div>\r\n    )\r\n}","import { TextField } from \"@material-ui/core\"\r\n\r\nexport default function UploadSettingsDialog({ uploaderSettings: { startRow, idColumn, usePrincipColumn, whatColumn, anyContentColumn, numFactorsColumn, contentCodedColumn, alphEachResponseColumn }, onChange }) {\r\n    return (\r\n        <div>\r\n            <TextField\r\n                type=\"number\"\r\n                label=\"Starting row #\"\r\n                value={startRow}\r\n                onChange={(event) => onChange({ startRow: parseInt(event.target.value) })}\r\n                inputProps={{\r\n                    min: 0\r\n                }}\r\n            />\r\n            <TextField\r\n                type=\"number\"\r\n                label=\"'ID' column #\"\r\n                value={idColumn}\r\n                onChange={(event) => onChange({ idColumn: parseInt(event.target.value) })}\r\n                inputProps={{\r\n                    min: 0\r\n                }}\r\n            />\r\n            <TextField\r\n                type=\"number\"\r\n                label=\"'Use.Princip' column #\"\r\n                value={usePrincipColumn}\r\n                onChange={(event) => onChange({ usePrincipColumn: parseInt(event.target.value) })}\r\n                inputProps={{\r\n                    min: 0\r\n                }}\r\n            />\r\n            <TextField\r\n                type=\"number\"\r\n                label=\"'What?'column #\"\r\n                value={whatColumn}\r\n                onChange={(event) => onChange({ whatColumn: parseInt(event.target.value) })}\r\n                inputProps={{\r\n                    min: 0\r\n                }}\r\n            />\r\n            <TextField\r\n                type=\"number\"\r\n                label=\"'AnyContent?'column #\"\r\n                value={anyContentColumn}\r\n                onChange={(event) => onChange({ anyContentColumn: parseInt(event.target.value) })}\r\n                inputProps={{\r\n                    min: 0\r\n                }}\r\n            />\r\n            <TextField\r\n                type=\"number\"\r\n                label=\"'# Factors'column #\"\r\n                value={numFactorsColumn}\r\n                onChange={(event) => onChange({ numFactorsColumn: parseInt(event.target.value) })}\r\n                inputProps={{\r\n                    min: 0\r\n                }}\r\n            />\r\n            <TextField\r\n                type=\"number\"\r\n                label=\"'Content Coded'column #\"\r\n                value={contentCodedColumn}\r\n                onChange={(event) => onChange({ contentCodedColumn: parseInt(event.target.value) })}\r\n                inputProps={{\r\n                    min: 0\r\n                }}\r\n            />\r\n            <TextField\r\n                type=\"number\"\r\n                label=\"'ALPH.EachResp.'column #\"\r\n                value={alphEachResponseColumn}\r\n                onChange={(event) => onChange({ alphEachResponseColumn: parseInt(event.target.value) })}\r\n                inputProps={{\r\n                    min: 0\r\n                }}\r\n            />\r\n        </div>\r\n    )\r\n}","import logo from './logo.svg';\nimport './App.css';\nimport * as Excel from 'exceljs'\nimport * as FileSaver from 'file-saver'\nimport React from 'react'\nimport { Button, Input, Typography} from '@material-ui/core';\nimport { makeStyles } from '@material-ui/core';\nimport * as XlsxPopulate from 'xlsx-populate';\nimport { TextField } from '@material-ui/core';\nimport { Dialog, DialogActions, DialogContent, DialogTitle } from '@material-ui/core';\n\nimport ResponseBox from './ResponseBox'\nimport UploadSettingsDialog from './UploadSettingsDialog';\n\nconst useStyles = makeStyles((theme) => ({\n  input: {\n    display: 'none',\n  },\n  headerText: {\n    color: '#bbbbbb',\n  },\n  paperRoot: {\n    backgroundColor: 'red',\n  }\n}));\n\nfunction App() {\n\n  const defaultEnvSettings = {\n    startRow: parseInt(process.env.REACT_APP_DEFAULT_INPUT_START_ROW),\n    idColumn: parseInt(process.env.REACT_APP_DEFAULT_ID_COLUMN),\n    usePrincipColumn: parseInt(process.env.REACT_APP_DEFAULT_USEPRINCIP_COLUMN),\n    whatColumn: parseInt(process.env.REACT_APP_DEFAULT_WHAT_COLUMN),\n    anyContentColumn: parseInt(process.env.REACT_APP_DEFAULT_ANYCONTENT_COLUMN),\n    numFactorsColumn: parseInt(process.env.REACT_APP_DEFAULT_NUMFACTORS_COLUMN),\n    contentCodedColumn: parseInt(process.env.REACT_APP_DEFAULT_CONTENTCODED_COLUMN),\n    alphEachResponseColumn: parseInt(process.env.REACT_APP_DEFAULT_ALPHEACHRESPONSE_COLUMN),\n  };\n\n  const classes = useStyles();\n\n  const [responses, setResponses] = React.useState([{ id: 0, usePrincip: \"No\", whatPrincip: \"Meh\"}]);\n  const [workbook, setWorkbook] = React.useState(null);\n  const [mappedScoreData, setMappedScoreData] = React.useState({});\n  const [fileName, setFileName] = React.useState(\"None--Press the upload button to upload a .xlsx file.\")\n  const [settingsOpen, setSettingsOpen] = React.useState(false);\n  const [uploaderSettings, setUploaderSettings] = React.useState(defaultEnvSettings);\n  const [tempUploaderSettings, setTempUploaderSettings] = React.useState(defaultEnvSettings)\n\n  function getRawDataResponses(worksheet, { startRow, idColumn, usePrincipColumn, whatColumn, numFactorsColumn, contentCodedColumn }) {\n    let localResponses = [];\n    let currentRow = 0;\n    while (true) {\n      let principCell = getCell(worksheet, usePrincipColumn, startRow + currentRow);\n      if (!principCell || (principCell.value() !== 'Yes' && principCell.value() !== 'No')) { break; }\n      let idCell = getCell(worksheet, idColumn, startRow + currentRow);\n      let whatCell = getCell(worksheet, whatColumn, startRow + currentRow);\n      let numFactorsCell = getCell(worksheet, numFactorsColumn, startRow + currentRow);\n      let tagsCell = getCell(worksheet, contentCodedColumn, startRow + currentRow);\n      let currentTags = [];\n      if (tagsCell && tagsCell.value()) {\n        console.log(tagsCell.value());\n        const allTags = tagsCell.value().toString().split(\", \");\n        currentTags = allTags.filter((tag) => tag.trim() !== \"\");\n      }\n      let response = {\n        id: idCell.value(),\n        usePrincip: principCell.value(),\n        whatPrincip: whatCell.value(),\n        numFactors: (numFactorsCell.value())? numFactorsCell.value() : 0,\n        tags: currentTags,\n      }\n      localResponses.push(response);\n      currentRow++;\n    }\n    return localResponses;\n  }\n\n  // Column and row both start at index 0\n  function getCell(worksheet, column, row) {\n    // https://stackoverflow.com/questions/36129721/convert-number-to-alphabet-letter\n    const column_letter = (column+10).toString(36).toUpperCase();\n    console.log(column_letter);\n    const cellIndex = column_letter + (row + 1);\n    console.log(cellIndex);\n    return worksheet.cell(row+1, column+1);\n  }\n  \n  function downloadWorkbook(workbook, fileName) {\n    const EXCEL_EXTENSION = '.xlsx';\n    workbook.outputAsync()\n      .then((popBlob) => {\n        if (window.navigator && window.navigator.msSaveOrOpenBlob) {\n          window.navigator.msSaveOrOpenBlob(popBlob, \"populate-out.xlsx\");\n        }\n        else {\n          let url = window.URL.createObjectURL(popBlob);\n          let a = document.createElement(\"a\");\n          document.body.appendChild(a);\n          a.href = url;\n          a.download = fileName + EXCEL_EXTENSION;\n          a.click();\n          window.URL.revokeObjectURL(url);\n          document.body.removeChild(a);\n        }\n      })\n  }\n\n  function setDefaultSheetvalues(worksheet, startCell) {\n    let currentRow = 0;\n    const formulaString = '=SORT(FILTER(OFFSET(G3,0,0,COUNT(F:F)-1), (OFFSET(G3,0,0,COUNT(F:F)-1)<>\"\")))'\n    const simpleFormula = 'E3/F3'\n    while (true) {\n      let principCell = getCell(worksheet, startCell.c + 2, startCell.r + currentRow);\n      if (!principCell || (principCell.value() !== 'Yes' && principCell.value() !== 'No')) { break; }\n      getCell(worksheet,uploaderSettings.anyContentColumn, startCell.r + currentRow).value(0);\n      getCell(worksheet,uploaderSettings.numFactorsColumn, startCell.r + currentRow).value(0);\n      getCell(worksheet,uploaderSettings.alphEachResponseColumn, startCell.r + currentRow).value(\"\")\n      currentRow ++;\n    }\n  }\n\n  const handleFileUpload = (event) => {\n    if (event.target.files.length === 0) {\n      return;\n    }\n    let file = event.target.files[0];\n    XlsxPopulate.fromDataAsync(file)\n      .then((newWorkbook) => {\n        setFileName(event.target.value.split(\"\\\\\").pop());\n        clearResponses();\n        setWorkbook(newWorkbook);\n        let worksheet = newWorkbook.sheet(\"DAT\");\n        let dataResponses = getRawDataResponses(worksheet, uploaderSettings);\n        setResponses(dataResponses);\n        setDefaultSheetvalues(worksheet, {c:0,r:2});\n        let mappedScoringResponses = {};\n        for (let response of dataResponses) {\n          mappedScoringResponses[response.id] = {\n            id: response.id,\n            content: (response.tags.length !== 0),\n            contentTags: response.tags,\n          };\n        }\n        setMappedScoreData(mappedScoringResponses);\n        event.target.value = null;\n      });\n  }\n\n  function cellIndexByValue(worksheet, column, value, startRow=0) {\n    let rowIndex = startRow;\n    while (true) {\n      let currCell = getCell(worksheet, column, rowIndex);\n      if (!currCell) { return -1; }\n      if (rowIndex > 500) {\n        console.log(\"Encountered an infinite loop!\");\n        return -1;\n      }\n      if (currCell.value() === value) { return rowIndex; }\n      rowIndex ++;\n    }\n  }\n\n  function listToCommaSep(stringList) {\n    let output = \"\";\n    for (let i = 0; i < stringList.length; i ++) {\n      output += stringList[i];\n      if (i != stringList.length - 1) {\n        output += \", \";\n      }\n    }\n    return output;\n  }\n\n  // columnIndex starts at 0 for column A\n  function setColumnValues(worksheet, columnIndex, values, startRow=0) {\n    for (let i = 0; i < values.length; i ++) {\n      getCell(worksheet, columnIndex, startRow + i).value(values[i]);\n    }\n  }\n\n  const submitScoring = () => {\n    console.log(\"Submitting scoring using new function!\")\n    if (!workbook) {\n      console.log(\"No workbook!\");\n      return;\n    }\n    let worksheet = workbook.sheet('DAT');\n    let allContentTags = [];\n    for (let scoring of Object.values(mappedScoreData)) {\n      let targetRow = cellIndexByValue(worksheet, uploaderSettings.idColumn, scoring.id, 2);\n      if (targetRow === -1) { continue; }\n      getCell(worksheet, uploaderSettings.anyContentColumn, targetRow).value((scoring.content)? 1 : 0);\n      getCell(worksheet, uploaderSettings.numFactorsColumn, targetRow).value(scoring.contentTags.length);\n      getCell(worksheet, uploaderSettings.contentCodedColumn, targetRow).value(listToCommaSep(scoring.contentTags));\n      allContentTags.push(...(scoring.contentTags));\n    }\n    setColumnValues(worksheet, uploaderSettings.alphEachResponseColumn, allContentTags.sort(), 2);\n    downloadWorkbook(workbook, \"newlib_output\");\n  }\n\n  const handleScoringChange = (id) => (targetData) => {\n    mappedScoreData[id] = targetData;\n    setMappedScoreData(mappedScoreData);\n  }\n\n  const clearResponses = () => {\n    setResponses([]);\n  }\n\n  const handleSubmitSettings = () => {\n    setSettingsOpen(false);\n    setUploaderSettings({...uploaderSettings, ...tempUploaderSettings});\n  }\n\n  const handleCancelSettings = () => {\n    setSettingsOpen(false);\n    setTempUploaderSettings({...uploaderSettings});\n  }\n\n  return (\n    <div className>\n      <div className=\"top-bar sticky\">\n        <div className=\"file-manager\">\n          <input\n            type='file'\n            accept=\".xlsx\"\n            className={classes.input}\n            id='contained-button-file'\n            onChange={handleFileUpload}\n          />\n          <label\n            htmlFor='contained-button-file'>\n            <Button variant=\"contained\" component=\"span\">Upload spreadsheet</Button>\n          </label>\n          <Button onClick={() => setSettingsOpen(true)}>(Uploader settings)</Button>\n          <Dialog open={settingsOpen} aria-labelledby=\"settings-dialog-title\">\n            <DialogTitle id=\"settings-dialog-title\">Uploader settings</DialogTitle>\n            <DialogContent>\n              <UploadSettingsDialog\n                uploaderSettings={tempUploaderSettings}\n                onChange={(newSettings) => { setTempUploaderSettings({ ...tempUploaderSettings, ...newSettings }) }}\n              />\n            </DialogContent>\n            <DialogActions>\n              <Button onClick={handleCancelSettings}>Cancel</Button>\n              <Button onClick={handleSubmitSettings}>Apply</Button>\n            </DialogActions>\n          </Dialog>\n          <Typography className={classes.headerText}>Now scoring: {fileName}</Typography>\n        </div>\n        <div className='download-interface'>\n          <Button variant=\"contained\" onClick={submitScoring}>Download spreadsheet</Button>\n        </div>\n      </div>\n      <div className=\"response-container-container\">\n        {responses.map((response) => {\n          if (response.usePrincip === 'No' || response.whatPrincip === '' || !(response.whatPrincip)) { return null; }\n          return (\n            <div className=\"response-container\">\n              <ResponseBox \n                id={response.id} \n                whatPrinciples={response.whatPrincip} \n                onChange={handleScoringChange(response.id)}\n                startTags={response.tags}\n                hasStartContent={response.tags.length !== 0}>\n              </ResponseBox>\n            </div>\n          )\n      })}\n      </div>\n    </div>\n  );\n}\n\nexport default App;","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}