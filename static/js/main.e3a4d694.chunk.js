(this["webpackJsonpreact-gh-test3"]=this["webpackJsonpreact-gh-test3"]||[]).push([[0],{206:function(e,n,t){},207:function(e,n,t){},212:function(e,n,t){},238:function(e,n){},242:function(e,n){},244:function(e,n){},253:function(e,n){},255:function(e,n){},280:function(e,n){},282:function(e,n){},283:function(e,n){},288:function(e,n){},290:function(e,n){},296:function(e,n){},298:function(e,n){},317:function(e,n){},329:function(e,n){},332:function(e,n){},336:function(e,n,t){"use strict";t.r(n);var a=t(0),c=t.n(a),o=t(12),i=t.n(o),r=(t(206),t(189)),l=t(82),s=t(33),u=(t.p,t(207),t(208),t(211),t(381)),d=t(376),f=t(377),h=t(4),v=t(372),j=t(373),b=t(191),p=t(375),g=t(382),O=t(379),m=t(371),x=t(187),N=t.n(x),w=t(186),k=t.n(w),C=t(85),y=(t(212),t(7)),P=Object(h.a)({switchBase:{color:C.a[50],"&$checked":{color:C.a[900]},"&$checked + $track":{backgroundColor:C.a[900]}},checked:{},track:{}})(u.a),S=Object(v.a)((function(e){return{paperRoot:{width:"100%",height:"100%",backgroundColor:"#343a42",borderColor:"gray"}}}));function T(e){var n=e.id,t=e.whatPrinciples,a=e.onChange,o=e.startTags,i=e.hasStartContent,r=S(),u=c.a.useState(i),h=Object(s.a)(u,2),v=h[0],x=h[1],w=c.a.useState(o.map((function(e,n){return{id:n,tagName:e}}))),C=Object(s.a)(w,2),T=C[0],R=C[1],E=c.a.useState(o.length+5),D=Object(s.a)(E,2),F=D[0],A=D[1],L=c.a.useRef(null);function U(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(""!==n)return!0;var t,a=Object(l.a)(T);try{for(a.s();!(t=a.n()).done;){var c=t.value;if(c.id!==e&&""!==c.tagName)return!0}}catch(o){a.e(o)}finally{a.f()}return""!==n}var B=function(e){return function(n){var t=n.target.value.replace(/^\s*/,"");R(T.map((function(n){return{id:n.id,tagName:n.id===e?t:n.tagName}}))),x(U(e,t))}},I=function(){A(F+1),T.push({id:F,tagName:""}),R(T)},$=function(e){return function(){R(T.filter((function(n){return n.id!=e}))),x(U(e))}},J=function(e){var n=e.key;"Enter"!==n&&","!==n||(e.preventDefault(),I()),"Escape"===n&&document.activeElement.blur()};return c.a.useEffect((function(){a({id:n,content:v,contentTags:T.map((function(e){return e.tagName})).filter((function(e){return""!=e}))})}),[T,v]),Object(y.jsx)("div",{className:"response-box",children:Object(y.jsxs)(j.a,{className:r.paperRoot,elevation:3,children:[Object(y.jsx)("div",{className:"id-container",children:Object(y.jsxs)(b.a,{display:"inline",children:["ID: ",n]})}),Object(y.jsx)("div",{className:"explanation-container",children:Object(y.jsx)(b.a,{display:"block",children:t})}),Object(y.jsxs)("div",{className:"coding-container",children:[Object(y.jsxs)("div",{className:"content-codes-container",children:[T.map((function(e){return Object(y.jsx)("div",{className:"tag-container",ref:L,children:Object(y.jsx)(O.a,{autoFocus:!0,placeholder:"Content code",onKeyPress:J,value:e.tagName,onChange:B(e.id),ref:L,InputProps:{endAdornment:Object(y.jsx)(p.a,{position:"end",children:Object(y.jsx)(g.a,{title:"Remove",children:Object(y.jsx)(m.a,{"aria-label":"toggle password visibility",onClick:$(e.id),size:"small",children:Object(y.jsx)(k.a,{})})})})}})})})),Object(y.jsx)(g.a,{title:"Add tag",children:Object(y.jsx)(m.a,{onClick:I,children:Object(y.jsx)(N.a,{})})})]}),Object(y.jsx)("div",{className:"has-content-container",children:Object(y.jsx)(d.a,{children:Object(y.jsx)(g.a,{title:"Enabled if one or more non-empty content codes are listed.",children:Object(y.jsx)(f.a,{control:Object(y.jsx)(P,{checked:v,onChange:function(e){}}),label:"Content?",labelPlacement:"top"})})})})]})]})})}var R=t(378),E=t(188),D=Object(v.a)((function(e){return{input:{display:"none"},headerText:{color:"#bbbbbb"},paperRoot:{backgroundColor:"red"}}}));var F=function(){var e=D(),n=c.a.useState([{id:0,usePrincip:"No",whatPrincip:"Meh"}]),t=Object(s.a)(n,2),a=t[0],o=t[1],i=c.a.useState(null),u=Object(s.a)(i,2),d=u[0],f=u[1],h=c.a.useState({}),v=Object(s.a)(h,2),j=v[0],p=v[1],g=c.a.useState("None--Press the upload button to upload a .xlsx file."),O=Object(s.a)(g,2),m=O[0],x=O[1];function N(e,n,t){var a=(n+10).toString(36).toUpperCase();console.log(a);var c=a+(t+1);return console.log(c),e.cell(c)}function w(e,n,t){for(var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,c=a;;){var o=N(e,n,c);if(!o)return-1;if(c>500)return console.log("Encountered an infinite loop!"),-1;if(o.value()===t)return c;c++}}function k(e){for(var n="",t=0;t<e.length;t++)n+=e[t],t!=e.length-1&&(n+=", ");return n}var C=function(){o([])};return Object(y.jsxs)("div",{className:!0,children:[Object(y.jsxs)("div",{className:"top-bar sticky",children:[Object(y.jsxs)("div",{className:"file-manager",children:[Object(y.jsx)("input",{type:"file",accept:".xlsx",className:e.input,id:"contained-button-file",onChange:function(e){if(0!==e.target.files.length){var n=e.target.files[0];E.fromDataAsync(n).then((function(n){x(e.target.value.split("\\").pop()),C(),f(n);var t=n.sheet("DAT"),a=function(e,n){for(var t=[],a=0;;){var c=N(e,n.c+2,n.r+a);if(!c||"Yes"!==c.value()&&"No"!==c.value())break;var o=N(e,n.c,n.r+a),i=N(e,n.c+3,n.r+a),r=N(e,n.c+5,n.r+a),l=N(e,n.c+6,n.r+a),s=[];l&&l.value()&&(console.log(l.value()),s=l.value().toString().split(", ").filter((function(e){return""!==e.trim()})));var u={id:o.value(),usePrincip:c.value(),whatPrincip:i.value(),numFactors:r.value()?r.value():0,tags:s};t.push(u),a++}return t}(t,{c:0,r:2});o(a),function(e,n){for(var t=0;;){var a=N(e,n.c+2,n.r+t);if(!a||"Yes"!==a.value()&&"No"!==a.value())break;N(e,n.c+4,n.r+t).value(0),N(e,n.c+5,n.r+t).value(0),N(e,n.c+9,n.r+t).value(""),t++}}(t,{c:0,r:2});var c,i={},r=Object(l.a)(a);try{for(r.s();!(c=r.n()).done;){var s=c.value;i[s.id]={id:s.id,content:0!==s.tags.length,contentTags:s.tags}}}catch(u){r.e(u)}finally{r.f()}p(i),e.target.value=null}))}}}),Object(y.jsx)("label",{htmlFor:"contained-button-file",children:Object(y.jsx)(R.a,{variant:"contained",component:"span",children:"Upload spreadsheet"})}),Object(y.jsxs)(b.a,{className:e.headerText,children:["Now scoring: ",m]})]}),Object(y.jsx)("div",{className:"download-interface",children:Object(y.jsx)(R.a,{variant:"contained",onClick:function(){if(console.log("Submitting scoring using new function!"),d){for(var e=d.sheet("DAT"),n=[],t=0,a=Object.values(j);t<a.length;t++){var c=a[t],o=w(e,0,c.id,2);-1!==o&&(N(e,4,o).value(c.content?1:0),N(e,5,o).value(c.contentTags.length),N(e,6,o).value(k(c.contentTags)),n.push.apply(n,Object(r.a)(c.contentTags)))}!function(e,n,t){for(var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,c=0;c<t.length;c++)N(e,n,a+c).value(t[c])}(e,9,n.sort(),2),function(e,n){e.outputAsync().then((function(e){if(window.navigator&&window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(e,"populate-out.xlsx");else{var t=window.URL.createObjectURL(e),a=document.createElement("a");document.body.appendChild(a),a.href=t,a.download=n+".xlsx",a.click(),window.URL.revokeObjectURL(t),document.body.removeChild(a)}}))}(d,"newlib_output")}else console.log("No workbook!")},children:"Download spreadsheet"})})]}),Object(y.jsx)("div",{className:"response-container-container",children:a.map((function(e){return"No"!==e.usePrincip&&""!==e.whatPrincip&&e.whatPrincip?Object(y.jsx)("div",{className:"response-container",children:Object(y.jsx)(T,{id:e.id,whatPrinciples:e.whatPrincip,onChange:(n=e.id,function(e){j[n]=e,p(j)}),startTags:e.tags,hasStartContent:0!==e.tags.length})}):null;var n}))})]})},A=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,383)).then((function(n){var t=n.getCLS,a=n.getFID,c=n.getFCP,o=n.getLCP,i=n.getTTFB;t(e),a(e),c(e),o(e),i(e)}))};i.a.render(Object(y.jsx)(c.a.StrictMode,{children:Object(y.jsx)(F,{})}),document.getElementById("root")),A()}},[[336,1,2]]]);
//# sourceMappingURL=main.e3a4d694.chunk.js.map