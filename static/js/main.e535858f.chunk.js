(this["webpackJsonpreact-gh-test3"]=this["webpackJsonpreact-gh-test3"]||[]).push([[0],{82:function(e,t,n){},83:function(e,t,n){},86:function(e,t,n){},92:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),r=n(10),i=n.n(r),o=(n(82),n(65)),s=n(38),l=n(20),u=(n.p,n(83),n(55)),d=n(56),v=n(136),f=n(128),h=n(129),j=n(4),b=n(67),g=n(131),p=n(137),x=n(134),O=n(127),m=n(64),N=n.n(m),k=n(63),w=n.n(k),y=n(47),C=(n(86),n(6)),P=Object(j.a)({switchBase:{color:y.a[50],"&$checked":{color:y.a[900]},"&$checked + $track":{backgroundColor:y.a[900]}},checked:{},track:{}})(v.a);function S(e){var t=e.id,n=e.whatPrinciples,a=e.onChange,r=e.startTags,i=e.hasStartContent,o=c.a.useState(i),u=Object(l.a)(o,2),d=u[0],v=u[1],j=c.a.useState(r.map((function(e,t){return{id:t,tagName:e}}))),m=Object(l.a)(j,2),k=m[0],y=m[1],S=c.a.useState(r.length+5),T=Object(l.a)(S,2),F=T[0],A=T[1],B=c.a.useRef(null);function D(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(""!==t)return!0;var n,a=Object(s.a)(k);try{for(a.s();!(n=a.n()).done;){var c=n.value;if(c.id!==e&&""!==c.tagName)return!0}}catch(r){a.e(r)}finally{a.f()}return""!==t}var E=function(e){return function(t){y(k.map((function(n){return{id:n.id,tagName:n.id===e?t.target.value:n.tagName}}))),v(D(e,t.target.value))}},I=function(){A(F+1),k.push({id:F,tagName:""}),y(k)},R=function(e){return function(){y(k.filter((function(t){return t.id!=e}))),v(D(e))}},U=function(e){var t=e.key;"Enter"!==t&&","!==t||(e.preventDefault(),I()),"Escape"===t&&document.activeElement.blur()};return c.a.useEffect((function(){a({id:t,content:d,contentTags:k.map((function(e){return e.tagName})).filter((function(e){return""!=e}))})}),[k,d]),Object(C.jsxs)("div",{className:"response-box",children:[Object(C.jsx)("div",{className:"id-container",children:Object(C.jsxs)(b.a,{display:"inline",children:["ID: ",t]})}),Object(C.jsx)("div",{className:"explanation-container",children:Object(C.jsx)(b.a,{display:"block",children:n})}),Object(C.jsxs)("div",{className:"coding-container",children:[Object(C.jsx)("div",{className:"has-content-container",children:Object(C.jsx)(f.a,{children:Object(C.jsx)(h.a,{control:Object(C.jsx)(P,{checked:d,onChange:function(e){v(e.target.checked)}}),label:"Content?",labelPlacement:"top"})})}),Object(C.jsxs)("div",{className:"content-codes-container",children:[k.map((function(e){return Object(C.jsx)("div",{className:"tag-container",ref:B,children:Object(C.jsx)(x.a,{autoFocus:!0,placeholder:"Content code",onKeyPress:U,value:e.tagName,onChange:E(e.id),ref:B,InputProps:{endAdornment:Object(C.jsx)(g.a,{position:"end",children:Object(C.jsx)(p.a,{title:"Remove",children:Object(C.jsx)(O.a,{"aria-label":"toggle password visibility",onClick:R(e.id),size:"small",children:Object(C.jsx)(w.a,{})})})})}})})})),Object(C.jsx)(p.a,{title:"Add tag",children:Object(C.jsx)(O.a,{onClick:I,children:Object(C.jsx)(N.a,{})})})]})]})]})}var T=n(133),F=n(132),A=Object(F.a)((function(e){return{input:{display:"none"},headerText:{color:"#bbbbbb"}}}));var B=function(){var e=A(),t=c.a.useState([{id:0,usePrincip:"No",whatPrincip:"Meh"}]),n=Object(l.a)(t,2),a=n[0],r=n[1],i=c.a.useState(null),v=Object(l.a)(i,2),f=v[0],h=v[1],j=c.a.useState([]),g=Object(l.a)(j,2),p=g[0],x=g[1],O=c.a.useState({}),m=Object(l.a)(O,2),N=m[0],k=m[1],w=c.a.useState("None--Press the upload button to upload a .xlsx file."),y=Object(l.a)(w,2),P=y[0],F=y[1];function B(e,t,n){var a=(t+10).toString(36).toUpperCase();console.log(a);var c=a+(n+1);return console.log(c),e.getCell(c)}function D(e,t,n){for(var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,c=a;;){var r=B(e,t,c);if(!r)return-1;if(c>500)return console.log("Encountered an infinite loop!"),-1;if(r.value===n)return c;c++}}function E(e){for(var t="",n=0;n<e.length;n++)t+=e[n],n!=e.length-1&&(t+=", ");return t}var I=function(){r([])};return Object(C.jsxs)("div",{className:!0,children:[Object(C.jsxs)("div",{className:"top-bar sticky",children:[Object(C.jsxs)("div",{className:"file-manager",children:[Object(C.jsx)("input",{type:"file",accept:".xlsx",className:e.input,id:"contained-button-file",onChange:function(e){if(0!==e.target.files.length){var t=e.target.files[0];F(e.target.value.split("\\").pop());var n=new u.Workbook,a=new FileReader;a.onload=function(){I();var t=a.result;n.xlsx.load(t).then((function(t){h(t);var n=t.getWorksheet("DAT"),a=function(e,t){for(var n=[],a=0;;){var c=B(e,t.c+2,t.r+a);if(!c||"Yes"!==c.value&&"No"!==c.value)break;var r=B(e,t.c,t.r+a),i=B(e,t.c+3,t.r+a),o=B(e,t.c+5,t.r+a),s=B(e,t.c+6,t.r+a),l=[];s&&s.value&&(console.log(s.value),l=s.value.toString().split(", "));var u={id:r.value,usePrincip:c.value,whatPrincip:i.value,numFactors:o.value?o.value:0,tags:l};n.push(u),a++}return n}(n,{c:0,r:2});r(a),function(e,t){for(var n=0;;){var a=B(e,t.c+2,t.r+n);if(!a||"Yes"!==a.value&&"No"!==a.value)break;B(e,t.c+4,t.r+n).value=0,B(e,t.c+5,t.r+n).value=0,n++}}(n,{c:0,r:2});var c,i=[],o=Object(s.a)(a);try{for(o.s();!(c=o.n()).done;){var l=c.value;i.push({id:l.id,content:!1,contentTags:[]})}}catch(f){o.e(f)}finally{o.f()}x(i);var u,d=Object(s.a)(a);try{for(d.s();!(u=d.n()).done;){var v=u.value;i[v.id]={id:v.id,content:!1,contentTags:[]}}}catch(f){d.e(f)}finally{d.f()}k({}),e.target.value=null}))},a.readAsArrayBuffer(t),console.log("File has been uploaded!")}}}),Object(C.jsx)("label",{htmlFor:"contained-button-file",children:Object(C.jsx)(T.a,{variant:"contained",component:"span",children:"Upload spreadsheet"})}),Object(C.jsxs)(b.a,{className:e.headerText,children:["Now scoring: ",P]})]}),Object(C.jsx)("div",{children:Object(C.jsx)(T.a,{variant:"contained",onClick:function(){if(console.log("Submitting scoring using new function!"),f){console.log(p);for(var e=f.getWorksheet("DAT"),t=[],n=0,a=Object.values(N);n<a.length;n++){var c=a[n],r=D(e,0,c.id,2);-1!==r&&(B(e,4,r).value=c.content?1:0,B(e,5,r).value=c.contentTags.length,B(e,6,r).value=E(c.contentTags),t.push.apply(t,Object(o.a)(c.contentTags)))}!function(e,t,n){for(var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,c=0;c<n.length;c++)B(e,t,a+c).value=n[c]}(e,9,t.sort(),2);!function(e,t){e.xlsx.writeBuffer().then((function(e){var n=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});d.saveAs(n,t+".xlsx")}))}(f,"newlib_output")}else console.log("No workbook!")},children:"Download spreadsheet"})})]}),Object(C.jsx)("div",{className:"response-container-container",children:a.map((function(e){return"No"===e.usePrincip||""===e.whatPrincip?null:Object(C.jsx)("div",{className:"response-container",children:Object(C.jsx)(S,{id:e.id,whatPrinciples:e.whatPrincip,onChange:(t=e.id,function(e){N[t]=e,k(N)}),startTags:e.tags,hasStartContent:0!==e.numFactors})});var t}))})]})},D=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,138)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,r=t.getLCP,i=t.getTTFB;n(e),a(e),c(e),r(e),i(e)}))};i.a.render(Object(C.jsx)(c.a.StrictMode,{children:Object(C.jsx)(B,{})}),document.getElementById("root")),D()}},[[92,1,2]]]);
//# sourceMappingURL=main.e535858f.chunk.js.map